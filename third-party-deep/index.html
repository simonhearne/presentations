<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	
	<title>Third-party content: a deep dive - @SimonHearne</title>
	
	<meta name="description" content="Presentation: Third-party content: a deep dive">
	<meta name="author" content="Simon Hearne">
	
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	
	<link rel="stylesheet" href="../css/reveal.css">
	<link rel="stylesheet" href="../css/theme/simon.css" id="theme">
	
	<meta property=‚Äúog:image‚Äù content="https://simonhearne.com/presentations/third-party-deep/social_third-party-deep.jpg" />
	<meta property=‚Äùog:image:width‚Äù content=1200" />
	<meta property=‚Äùog:image:height‚Äù content=699 />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@SimonHearne" />
	<meta name="twitter:title" content="Third-party content: a deep dive">
	<meta name="twitter:description" content="An interactive presentation exploring the impact of third-party content on web performance and security." />
	<meta name="twitter:image" content="https://simonhearne.com/presentations/third-party-deep/social_third-party-deep.jpg" />
	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement( 'link' );
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match( /print-pdf/gi ) ? '../css/print/pdf.css' : '../css/print/paper.css';
		document.getElementsByTagName( 'head' )[0].appendChild( link );
	</script>
	
	<script src="../lib/js/head.min.js"></script>
	<script src="../js/reveal-3.8.0.js"></script>
	<script src="../lib/js/jquery-3.3.1.min.js"></script>
	
	<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>
	
	<body>
		<div class="reveal">
			<div class="smaller tagline">@SimonHearne</div>
			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section class="center" data-background-image="../backgrounds/underwater.jpg" data-background-fit="stretch">
					<h1>Third-party Content<br><em>a deep dive</em></h1>
					<div class="bottom" style="position: fixed;bottom: 0;width: 100%;text-align: center;">
						<p style="margin-bottom:0;">Simon Hearne</p>
						<p class="smaller">Web Performance Solutions Engineer @ Akamai</p>		
						<p id="help-text" class="help-text"></p>
					</div>
					<aside class="notes">
						Welcome to this talk on third-party content.<br>
						If you are viewing this live, use keys 'n' and 'p' to navigate the slides.
						Use key 'o' to view an overview. <a style="cursor: pointer" onclick="javascript:Reveal.configure({showNotes: false})">Click here to hide these notes</a>.
					</aside>
				</section>
				
				<section data-background-image="media/requestmap.png" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.5">
					<h2>Third-parties?</h2>
					<div class="dark-bg">
						<p class="fragment">Content served from a domain outside of your control</p>
						<ul class="fragment" style=" font-size: 80%;">
							<li>Analytics</li>
							<li>Advertising</li>
							<li>Optimisation</li>
							<li>JS CDNs</li>
							<li>Tag Management</li>
							<li>...</li>
						</ul>
					</div>
					<aside class="notes">
						Third-party content is stuff that's on your apps but outside of your control.<br>
						They're offten added after release, by teams not in the development side of the house.
					</aside>
				</section>
				
				<section class="center" data-background-image="media/requestmap.png" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.25">
					<p style="margin: 0">The median website is</p>
					<p style="font-size: 400%; font-weight: bolder; margin:0;">37%</p>
					<p style="margin: 0">third-party requests</p>
					<p class="smallest bottom-right">Source: HTTP Archive 2019-10-01</p>
					<aside class="notes">
						Third-parties add value to websites, improve customer insight and allow monetisation.<br>
						So it's no surprise that there are a lot of them!
					</aside>
				</section>

				<section data-background-image="media/wpt1.png" data-background-fit="contain" data-background-color="#000">
				</section>
				<section data-background-image="media/reqmap1.png" data-background-fit="contain" data-background-color="#000">
				</section>
				
				<section class="bottom" data-background-image="../backgrounds/shout.jpg" data-background-fit="stretch">
					<h3 class="dark-bg">Sometimes it feels like we're getting nowhere</h3>
					<aside class="notes">
						We've been talking about third-party performance for years! In my case it's been five years, to the day!<br>
						I've given a few talks about third-parties, I've given workshops, audits and reports.<br>
						Unfortunately not a huge amount has changed, we're using more third-parties than ever.
					</aside>
				</section>
				
				<section class="center" data-background-image="../backgrounds/crack.jpg" data-background-fit="stretch">
					<h3 class="dark-bg">It can feel like 'us vs them'</h3>
					<aside class="notes">
						It feels like there's a disconnect between the many folks who have ownership of a web app
					</aside>
				</section>
				
				<section class="center">
					<p style="line-height:1.9">
						everyone who works on a web product<br><i style="font-size:130%">shares ownership of performance and security</i><br><span class="fragment">(whether they know it or not)</span>
					</p>
				</section>
				
				<section class="" data-background-image="../backgrounds/youarehere.jpg" data-background-fit="stretch">
					<aside class="notes">
						As you are viewing this slide deck, I'm going to make an assumption that you are hands-on.<br>
						How many in the audience actively work on a web product (developer / product / ops / marketing)?<br>
						Keep your hand up if you touch code.<br>
						<br>
						So the majority of us here actively work on code. There will be very few representatives from User Experience, Marketing, Product, BI & Analytics in this room.
					</aside>
				</section>
				
				<section class="bottom" data-background-image="../backgrounds/frustration.jpg" data-background-fit="stretch">
					<h3 class="dark-bg">Another tracking script?!</h3>
					<aside class="notes">
						That means that for most of you, third-party content is more of an irritation and frustration rather than a source of revenue, insight or joy.
					</aside>
				</section>
				
				<section class="bottom" data-background-image="../backgrounds/bigdata.jpg" data-background-fit="stretch">
					<h3 class="dark-bg">Regulations are increasing visibility</h3>
					<aside class="notes">
						While regulations such as GDPR and cookie consent laws have caused a lot of frustration, they have the positive effect of bringing third-party accountability to the foreground.<br>
						Plus the unfortunate acronym for China's Personal Information Security Specification.
					</aside>
				</section>
				
				<section class="center" data-background-image="media/requestmap.png" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.5">
					<h3 class="dark-bg">Tag managers are enablers</h3>
					<aside class="notes">
						We have developed tools to move ownership of third-parties away from technical teams.<br>
						While this is a good thing for velocity, it has diluted ownership of the front-end.
					</aside>
				</section>
				
				<section data-background-image="../backgrounds/super.jpg" data-background-fit="stretch">
					<h2>Fancy a super power?</h2>
					<aside class="notes">
						It's unlikely that anyone will become a full-time third-party regulator. What you can become is the subject matter expert.<br>
						I've known a number of engineers who have become the third-party SME, accidentally or purposefully, and it has been a net positive on their careers and the products they work on.<br>
						In the next half hour I will try to arm you with the stories, tools and techniques to manage third-party content. I'll do this through post-mortems of some recent incidents.
					</aside>
				</section>
				
				<!--
					<section class="center" data-background-color="#000">
						<h2>Some definitions</h2>
						<ul>
							<li class="fragment">RUM</li>
							<li class="fragment">HTTP Archive</li>
							<li class="fragment">RUM</li>
							<li class="fragment">RUM</li>
						</ul>
					</section>
				-->
				
				<section>
					<section class="bottom" data-background-image="../backgrounds/bored.jpg" data-background-fit="stretch">
						<h2 class="dark-bg">Incident 1: the 30s wait</h2>
						<aside class="notes">
							This is the incident that got me interested in third-parties in the first place.<br>
							A client had just launched a new version of their site across asia<br>
							All the pre-production tests worked fine, they tested from servers in the target geos and performance was good
						</aside>
					</section>
					<section class="center" data-background-image="../backgrounds/bored.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>Launched in China üá®üá≥</h3>
						<ul class="no-bullets">
							<li class="fragment">üëç localisation</li>
							<li class="fragment">üëç dev testing</li>
							<li class="fragment">üëç QA in China</li>
						</ul>
						<aside class="notes">
							The launch was continued to China.<br>
							Feedback from local users was extremely poor and analytics showed page load times of over 30s.
						</aside>
					</section>
					<section data-background-image="../backgrounds/bored.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>The problem</h3>
						<div class="wf-container" id="wf1">
							<div class="wf-row">
								<div class="wf-elem wf-label">index.html</div>
								<div class="wf-elem wf-dns"></div>
								<div class="wf-elem wf-tcp"></div>
								<div class="wf-elem wf-tls"></div>
								<div id="dld1" class="wf-elem wf-htm wf-width-2"></div>
							</div>
							<div class="wf-row">
								<div class="wf-elem wf-label">style.css</div>
								<div id="css1" class="wf-elem wf-blk wf-dep-1" data-offset="3" style="flex-basis: 5em"></div>
								<div class="wf-elem wf-css wf-width-3"></div>
							</div>
							<div class="wf-row">
								<div class="wf-elem wf-label">image1.jpg</div>
								<div id="css1" class="wf-elem wf-blk wf-dep-1" data-offset="3" style="flex-basis: 5em"></div>
								<div class="wf-elem wf-img wf-width-5"></div>
							</div>
							<div class="wf-row">
								<div class="wf-elem wf-label">image2.jpg</div>
								<div id="css1" class="wf-elem wf-blk wf-dep-1" data-offset="3" style="flex-basis: 5em"></div>
								<div class="wf-elem wf-img wf-width-6"></div>
							</div>
							<div class="wf-row">
								<div class="wf-elem wf-label">font.woff2</div>
								<div id="css1" class="wf-elem wf-blk wf-dep-1" data-offset="3" style="flex-basis: 5em"></div>
								<div class="wf-elem wf-dns"></div>
								<div class="wf-elem wf-tcp"></div>
								<div class="wf-elem wf-tls"></div>
								<div class="wf-elem wf-fnt wf-width-4"></div>
							</div>
							<div class="wf-row">
								<div class="wf-elem wf-label">script.js</div>
								<div id="js1" class="wf-elem wf-blk wf-dep-1" data-offset="3" style="flex-basis: 5em"></div>
								<div class="wf-elem wf-jss wf-width-5"></div>
							</div>
							<div class="wf-row">
								<div class="wf-elem wf-label">social.js</div>
								<div class="wf-elem wf-blk wf-dep-1" data-offset="3" style="flex-basis: 5em"></div>
								<div class="wf-elem wf-dns"></div>
								<div class="wf-elem wf-tcp"></div>
								<div class="wf-elem wf-tls"></div>
								<div class="wf-elem wf-jss wf-width-3"></div>
							</div>
							<div class="wf-row">
								<div class="wf-elem wf-label">image3.jpg</div>
								<div id="css1" class="wf-elem wf-blk wf-dep-1" data-offset="6" style="flex-basis: 10em"></div>
								<div class="wf-elem wf-img wf-width-6"></div>
							</div>
							<div class="wf-row">
								<div class="wf-elem wf-label">image4.jpg</div>
								<div id="css1" class="wf-elem wf-blk wf-dep-1" data-offset="6" style="flex-basis: 10.2em"></div>
								<div class="wf-elem wf-img wf-width-8"></div>
								<div class="wf-elem wf-loadtime" id="wf-plt-1" style="opacity:1">doc.ready()</div>
							</div>
							<div style="background-color: #fb0d0d38" class="wf-row fragment">
								<div class="wf-elem wf-label">fb.js</div>
								<div class="wf-elem wf-blk wf-dep-1" data-offset="3" style="flex-basis: 11em"></div>
								<div id="wf-js-dur-1" class="wf-elem wf-dns"></div>
								<div class="wf-elem wf-tcp"></div>
								<div class="wf-elem wf-tls"></div>
								<div id="wf-js-dur-1" class="wf-elem wf-jss wf-width-3"></div>
								<div class="wf-elem wf-loadtime" id="wf-plt-2" style="opacity:0">doc.ready()</div>
							</div>
							<div class="wf-row">
								<div class="wf-elem wf-label">important!</div>
								<div id="wf-js-dur-2" class="wf-elem wf-blk wf-dep-1" data-offset="11" style="flex-basis: 18.5em"></div>
								<div style="opacity:1" class="wf-elem wf-fnt wf-event"></div>
							</div>
						</div>
						<script>
							!function randomize() {
								let els = document.querySelectorAll('.wf-dns, .wf-tls, .wf-tcp');
								[].forEach.call(els,(el)=>{
									let w = Math.random() + 0.5;
									el.setAttribute('style','flex-basis:'+w+'em');
								})
							}()
							function simDelay1(d = 10) {
								var dld = document.getElementById("dld1")
								var dep1 = document.getElementById('wf-js-dur-1')
								var dep2 = document.getElementById('wf-js-dur-2')
								let r;
								if (!d) { r = 0.5} else { r = d + Math.random()*5}
								dep1.setAttribute('style',`flex-basis:${r}em`);
								if (d > 5) {
									document.getElementById('wf-plt-1').setAttribute('style',`opacity:0`);
									document.getElementById('wf-plt-2').setAttribute('style',`opacity:1`);
									dep2.setAttribute('style',`flex-basis:${r+16}em`);
								} else {
									document.getElementById('wf-plt-1').setAttribute('style',`opacity:1`);
									document.getElementById('wf-plt-2').setAttribute('style',`opacity:0`);
									dep2.setAttribute('style',`flex-basis:${18.5}em`);
								}
							}
						</script>
						<div class="fragment" data-eval-show="simDelay1(10)" data-eval-hide="simDelay1(false)"></div>
						<div class="fragment" data-eval-show="simDelay1(20)" data-eval-hide="simDelay1(10)"></div>
						<aside class="notes">
							The problem was an assumption that the document.ready event would not be impacted by the script.<br>
							The application design had critical event management logic on document.ready so the application was unavailable until it fired!
						</aside>
					</section>
					<section class="center" data-background-image="../backgrounds/bored.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>Don't worry, it's async!</h3>
					</section>
					<section data-background-image="../backgrounds/bored.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>sync is still king(!)</h3>
						<div style="zoom:0.8" class="vega-chart" id="vis1" data-spec="data/sync_vs_async.json"></div>
						<p class="smallest bottom-right">Source: HTTP Archive. 2016-05-15 to 2019-10-01</p>
					</section>
					<section class="center" data-background-image="../backgrounds/bored.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>The defense üëÆ‚Äç‚ôÄÔ∏è</h3>
						<ul>
							<li class="fragment">üá®üá≥ feature flag</li>
							<li class="fragment">don't block on onload</li>
							<li class="fragment"><code>&lt;script defer &gt;</code></li>
						</ul>
					</section>
					<section class="center" data-background-image="../backgrounds/bored.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>Beware your script loading strategy</h3>
						<embed class="plain stretch" id="nav-timing-svg" src="media/performance_api_blocking.svg" />
						<script>
							function toggleSVGVis(obj,ele,show=true) {
								let svgEl = document.getElementById(obj);
								if (svgEl) {
									let svgObj = svgEl.getSVGDocument()
									if (svgObj) {
										let i = svgObj.getElementById(ele);
										if (i) {
											if (show) {
												i.setAttribute('style','')
											} else {
												i.setAttribute('style','display:none')
											}
										}
									}
								}
							}
						</script>
						<div class="fragment" data-eval-show="toggleSVGVis('nav-timing-svg','g4382')" data-eval-hide="toggleSVGVis('nav-timing-svg','g4382',false)"></div>
						<aside class="notes">
							Deferred scripts run immediately after dominteractive: "when the parser finished its work on the main document"
						</aside>
					</section>
					<section data-background-image="../backgrounds/bored.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>Tag managers allow for this</h3>
						<img class="plain stretch" data-src="media/gtm_trigger_type.png">
						<p>Load scripts as late as possible</p>
						<aside class="notes">
							Tag managers offer flexibility to define when scripts are loaded.<br>
							By default, you'll probably find them loading too early (marketers always want their scripts to execute as soon as possible).<br>
							It is simple to evaluate when a script needs to evaluate, so make it a point to load scripts only when necessary.
						</aside>
					</section>
					<section class="center" data-background-image="../backgrounds/bored.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>Tag loading times (a rough guide)</h3>
						<div class="columns-three">
							<div class="column-three">
								<h5>Immediate ‚ö°Ô∏è</h5>
								<ul class="no-bullets smaller">
									<li>Experimentation</li>
									<li>Tag Manager</li>
								</ul>
							</div>
							<div class="column-three">
								<h5>Fast üëÄ</h5>
								<ul class="no-bullets smaller">
									<li>Session Tracking</li>
									<li>Performance Monitoring</li>
								</ul>
							</div>
							<div class="column-three">
								<h5>Late üêå</h5>
								<ul class="no-bullets smaller">
									<li>Ads(!)</li>
									<li>Reviews & Ratings</li>
									<li>Live Chat & Support</li>
								</ul>
							</div>
						</div>
						<aside class="notes">
							Don't treat your tags the same, some have to load early but most can be loaded late.
						</aside>
					</section>
				</section>
				
				
				<section>
					<section data-background-image="../backgrounds/burnmoney.jpg" data-background-fit="stretch">
						<h2 class="dark-bg">Incident 2: the missing revenue</h2>
						<aside class="notes">
							I was working with a UK retailer who had initiated a war room because their conversion rate had dropped by 30%.<br>
							Their automated tests were showing 100% success, they had not released any code and there were no stock changes.
						</aside>
					</section>
					<section class="center" data-background-image="../backgrounds/burnmoney.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>The problem</h3>
						<h4>Conversion rate down 30% overnight üìâ</h4>
					</section>
					<section data-background-image="../backgrounds/burnmoney.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>The discovery</h3><br>
						<pre style="width:100%; font-size: 50%; overflow: hidden;"><code class="js" data-trim="true">
							/**
							* This file uses jQuery materials and hashchange plugin 
							* Portions, Copyright (c) 2010 "Cowboy" Ben Alman
							* http://benalman.com/projects/jquery-hashchange-plugin/
							* Portions, Copyright 2012 jQueryFoundation and other contributors
							* http://jquery.com/
						</code></pre>
						<p class="smaller monospace">&lt;script async src="//thirdparty.com/embed.js"&gt;</p>
						<aside class="notes">
							The issue was a change in a third-party script. This was not announced publicly, and as the URL was absolute the change was pushed immediately.<br>
							The update conflicted with an event listener (poorly implemented by the client) which broke the quick checkout button.
						</aside>
					</section>
					<section data-background-image="../backgrounds/burnmoney.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>The discovery</h3>
						<img class="plain stretch" data-src="media/mpulse_errors.png">
						<aside class="notes">
							The issue went unnoticed by operations until questions were raised by ecommerce.<br>
							All testing was reporting 100% success, but there were some errors being logged to the console.<br>
							Due to alert fatigue, no-one was informed of the increase in errors. In this example we can see a massive spike before a huge drop in traffic, caused by a misconfigured third-party script.
						</aside>
					</section>
					<section data-background-image="../backgrounds/burnmoney.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>Subresource Integrity</h3>
						<div class="fragment"><br>
							<h4>Only execute code if it matches the hash</h4>
							<pre><code class="hlhtml" data-trim>
								&lt;script
								src="//thirdparty.com/embed.js"
								integrity="sha256-ivk71nXhz9nsyFDoYoGf2...="
								crossorigin="anonymous"&gt;
							</code>
						</pre>
						<p class="fragment">Currently used on <em>5.15%</em> of pages<br><span class="smaller">(HTTP Archive - 2019/10/01)</span></p>
						<p class="smallest bottom-right"><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">SRI on MDN</a></p></div>
						<aside class="notes">
							SRI enforces a version of a third-party asset. If the asset is changed without your knowledge it will not execute in the browser.<br>
							This is best used for non-critical assets, such as analytics. The failures will be silent, but can be reported with Content-Security-Policy.
						</aside>
					</section>
					<section class="center" data-background-image="../backgrounds/burnmoney.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
						<h3>Back to &lt;img&gt; pixels?</h3>
						<pre><code class="html" data-trim>
							<!-- Facebook Pixel Code -->
							&lt;script&gt;!function(f,b,e,v,n,t,s){...}();&lt;/script&gt;
							&lt;noscript&gt;
							&lt;img height="1" width="1" style="display:none"
							src="https://www.facebook.com/tr?id=...&noscript=1"
							/&gt;
							&lt;/noscript&gt;
						</code>
					</pre>
					<p class="smallest bottom-right"><a href="https://www.tunetheweb.com/blog/adding-controls-to-google-tag-manager/">Adding Controls to Google Tag Manager - Barry Pollard</a></p>
					<aside class="notes">
						Reduce the impact of third-party scripts, by swapping them for the fallback image pixel!<br>
						This will reduce the amount of data that can be collected, but that's not necessarily a bad thing.
					</aside>
				</section>
			</section>
			
		</section>
		
		
		<section>
			<section data-background-image="../backgrounds/chart.jpg" data-background-fit="stretch">
				<h2 class="dark-bg">Incident 3: the "performance" tool</h2>
				<aside class="notes">
					This was a performance monitoring tool that runs in the client, like mPulse RUM!<br>
					After implementatin there were a number of complaints from customers...
				</aside>
			</section>
			<section class="center" data-background-image="../backgrounds/chart.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The problem</h3>
				<br>
				<blockquote>The site feels "laggy"</blockquote>
				<p>üßê</p>
				<aside class="notes">
					The feedback was very subjective, and nothing in the data showed a performance problem.
				</aside>
			</section>
			<style>
				.indicator {
					width: 8em;
					height: 8em;
					line-height: 7.5em !important;
					background-color: blue;
					margin: 1em !important;
				}
				.indicator.activated {
					background-color: orange;
				}
			</style>
			<section data-background-image="../backgrounds/chart.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The problem</h3>
				<div class="fragment" data-eval-show="toggleIndicators()" data-eval-hide="toggleIndicators()" style="font-family: monospace; font-size: 90%">clicked!</div>
				<div>
					<span id="indicator-1" class="indicator">instant</span>
					<span id="indicator-2" class="indicator">500ms delay</span>
				</div>
				<script>
					toggleIndicators = (delayMs=500) => {
						document.getElementById('indicator-1').classList.toggle('activated');
						window.setTimeout(()=>{
							document.getElementById('indicator-2').classList.toggle('activated');
						},delayMs)
					}
				</script>
			</section>
			<section data-background-image="../backgrounds/chart.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The discovery</h3>
				<img class="plain stretch" data-src="media/onunload.png">
				<aside class="notes">
					The issue was caused by a combination of third-party event listeners.<br>
					In this example we can see ClickTale adding around a second to the unload event - this blocks the next navigation and is perceived as latency.
				</aside>
			</section>
			<section data-background-image="../backgrounds/chart.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The discovery</h3>
				<img class="plain stretch" data-src="media/mpulse_unload.png">
				<aside class="notes">
					This can be tracked in tools like mPulse, and correlated with things like bounce and conversion rate.
				</aside>
			</section>
			<section class="center" data-background-image="../backgrounds/chart.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The defense</h3>
				<ul>
					<li>Don't rely on synthetic tests</li>
					<li>Track unload duration</li>
					<li class="fragment">Track everything!</li>
				</ul>
			</section>
			<section class="center" data-background-image="../backgrounds/chart.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<blockquote>If it moves, we track it. Sometimes we‚Äôll draw a graph of something that isn‚Äôt moving yet, just in case it decides to make a run for it. </blockquote>
				<p class="smallest bottom-right"><a href="https://codeascraft.com/2011/02/15/measure-anything-measure-everything/">Measure Anything, Measure Everything - Ian Malpass</a></p>
			</section>
		</section>
		
		<section>
			<section data-background-image="../backgrounds/phone.jpg" data-background-fit="stretch">
				<h2 class="dark-bg">Incident 4: the review provider</h2>
				<aside class="notes">
					Customers love ratings and reviews, and prefer independent sources.
				</aside>
			</section>
			<section data-background-image="../backgrounds/phone.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The problem</h3>
				<img class="plain stretch" data-src="media/missguided1.png">
				<p class="smallest bottom-right"><a href="https://www.slideshare.net/AndyDavies/fast-fashion-how-missguided-revolutionised-their-approach-to-site-performance-deltav-conference-may-2018?from_action=save">How Missguided revolutionised thier approach to site speed</a></p>
				<aside class="notes">
					The problem in this case was that Android users had a significantly poorer experience.<br>
					As a result, the conversion rate for Android users was much lower than iPhones.
				</aside>
			</section>
			<section data-background-image="../backgrounds/phone.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The discovery</h3>
				<img class="plain stretch" data-src="media/bv1.png">
				<aside class="notes">
					A little bit of digging showed that the review provider was adding significant time to JS execution.
				</aside>
			</section>
			<section data-background-image="../backgrounds/phone.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The defense</h3>
				<img class="plain stretch" data-src="media/missguided2_trans.png">
				<aside class="notes">
					To evaluate the impact further, the reviews were removed from the website for Android visitors.
				</aside>
			</section>
			<section data-background-image="../backgrounds/phone.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<p style="font-size:200%">26%</p>
				<p>more revenue</p>
				<aside class="notes">
					The result was an increase in revenue of 26% from Android visitors.
				</aside>
			</section>
			<section class="center" data-background-image="../backgrounds/phone.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The defense</h3>
				<ul>
					<li>Adaptive tag loading</li>
					<li>Understand the impact</li>
					<li>Communicate with 3rd parties</li>
				</ul>
				<aside class="notes">
					This bit is really tricky - attribution is not something that is made available through any APIs so it can take manual measurements and intervention.
				</aside>
			</section>
		</section>
		
		<section>
			<section data-background-image="../backgrounds/ads.jpg" data-background-fit="stretch">
				<h2 class="dark-bg">Incident 5: the malicious ads</h2>
				<aside class="notes">
					Malvertising is a surprisingly common problem. While not necessarily a performance challenge, it's still a major concern.
				</aside>
			</section>
			<section data-background-image="../backgrounds/ads.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The problem</h3>
				<img class="plain" data-src="media/malvertising.svg">
			</section>
			<section data-background-image="../backgrounds/ads.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The discovery</h3>
				<img class="plain stretch" data-src="media/csp_mpulse.png">
				<aside class="notes">
					This issue was captured in mPulse.
				</aside>
			</section>
			<section data-background-image="../backgrounds/ads.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>Content Security Policy</h3>
				<pre><code data-trim class="csp wrap">
					content-security-policy: default-src *;
					script-src 'self' 'unsafe-inline' 'unsafe-eval' *.go-mpulse.net maps.googleapis.com;
					object-src *;
					style-src 'self' 'unsafe-inline' fonts.googleapis.com;
					img-src 'self' data: img.youtube.com *.akstat.io *.gstatic.com *.googleapis.com *.google-analytics.com *.ytimg.com;
					media-src 'self';
					frame-src 'self' *.youtube-nocookie.com;
					font-src 'self' *.gstatic.com data:;
					connect-src 'self' *.akstat.io *.go-mpulse.net *.google-analytics.com;
					report-uri https://akstat.io/report/&lt;api-key&gt;</code>
				</pre>
				<p class="fragment" style="margin-top: -20px;">Currently used on <em>6.11%</em> of pages<br><span class="smaller">(HTTP Archive - 2019/10/01)</span></p>
			</section>
			<section data-background-image="../backgrounds/ads.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>Content Security Policy</h3>
				<table class="table">
					<tr><th>CSP Directive</th><th>HTML / JS Features</th></tr>
					<tr><td>default-src</td><td>*</td></tr>
					<tr><td>connect-src</td><td>XMLHttpRequest(), WebSocket(),<br>EventSource(), sendBeacon(), fetch()</td></tr>
					<tr><td>style-src</td><td>&lt;link rel="stylesheet"&gt;</td></tr>
					<tr><td>script-src</td><td>&lt;script&gt;</td></tr>
					<tr><td>form-action</td><td>&lt;form&gt;</td></tr>
					<tr><td>font-src</td><td>@font-face</td></tr>
					<tr><td>child-src</td><td>&lt;iframe&gt;, Worker()</td></tr>
					<tr><td>object-src</td><td>&lt;object&gt;, &lt;embed&gt;</td></tr>
					<tr><td>media-src</td><td>&lt;video&gt;, &lt;audio&gt;</td></tr>
					<tr><td>img-src</td><td>&lt;img&gt;</td></tr>
					<tr><td>manifest-src</td><td>&lt;link rel="manifest"&gt;</td></tr>
				</table>
			</section>
		</section>
		
		
		<section>
			<section data-background-image="../backgrounds/monero.jpg" data-background-fit="stretch">
				<h2 class="dark-bg">Incident 6: the crypto miner</h2>
				<aside class="notes">
					This was reasonably well covered in the press.
				</aside>
			</section>
			<section data-background-image="../backgrounds/monero.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The problem</h3>
				<img class="plain stretch" data-src="media/coinhive1.png"/>
				<aside class="notes">
					The issue was caused by crypto miners, written in JS, snuck into third-pary libaries.<br>
					The miners pegged the CPU and made the user experience awful.
				</aside>
			</section>
			<section class="center" data-background-image="../backgrounds/monero.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The discovery</h3>
				<div class="tweet" data-src="https://twitter.com/Scott_Helme/status/962684239975272450"></div>
				<aside class="notes">
					Unfortunately for most site, the discovery was through twitter.
				</aside>
			</section>
			<section data-background-image="../backgrounds/monero.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>Many compromised services...</h3>
				<img class="plain stretch" data-src="media/cryptoloot1.png"/>
				<aside class="notes">
				</aside>
			</section>
			<section data-background-image="../backgrounds/monero.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>CryptoMiner Use</h3>
				<div style="zoom:0.75" class="vega-chart" id="vis2" data-spec="data/crypto.json"></div>
				<p class="smallest bottom-right">Source: HTTP Archive. 2017-09-15 to 2019-10-01</p>
				<aside class="notes">
					While the presence of crypto miners is apparently reducing...
				</aside>
			</section>
			<section class="center"data-background-image="../backgrounds/monero.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>Static analysis is not enough</h3>
				<div class="tweet" data-src="https://twitter.com/gwillem/status/1187667658642206720?s=19"></div>
				<aside class="notes">
					They could just be getting better at hiding.
				</aside>
			</section>
			<section class="center" data-background-image="../backgrounds/monero.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>The defense</h3>
				<ul>
					<li>Subresource Integrity</li>
					<li>Content-Security-Policy (connect-src)</li>
					<li>Track CPU metrics (TTI / CPU Idle)</li>
				</ul>
			</section>
		</section>
		
		<section>
			<section data-background-image="../backgrounds/experimentation.jpg" data-background-fit="stretch">
				<h2 class="dark-bg">Incident 7: the "optimisation"</h2>
				<aside class="notes">
				</aside>
			</section>
			<section class="center" data-background-image="../backgrounds/experimentation.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<blockquote>
					Our goal is not to make a fast website,<br>it is to maximise business success.
				</blockquote>
				<p class="smallest bottom-right"><a href="https://www.youtube.com/watch?v=oBD_kClamck">3rd parties: A hate / love - Kristian Sk√∂ld</a></p>
			</section>
			<section class="center" data-background-image="../backgrounds/experimentation.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3></h3>
				<img class="plain stretch" data-src="media/optimizely_speedcurve.png"/>
				<p class="smallest bottom-right"><a href="https://orangevalley.nl/en/9-ab-testing-tools-compared-on-site-speed-impact/">How A/B testing tools worsen your site speed - orangevalley</a></p>
				<aside class="notes">
					The customer implemented the performance optimisation tool and performance metrics tanked.
				</aside>
			</section>
			<section class="center" data-background-image="../backgrounds/experimentation.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>What's 500ms worth?</h3>
				<img class="plain stretch" data-src="media/optimizely_sla.png"/>
				<p class="smallest bottom-right"><a href="https://status.optimizely.com">status.optimizely.com</a></p>
				<aside class="notes">
					Optimizely's default implementation is a render-blocking script. Their SLA for performance is 500ms.<br>
					Half a second is a long time to block the user experience.
				</aside>
			</section>
			<section class="center" data-background-image="../backgrounds/experimentation.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>Proxy through your domain</h3>
				<img class="plain stretch" data-src="media/optimizely_proxy.png"/>
				<p class="smallest bottom-right"><a href="https://help.optimizely.com/Set_Up_Optimizely/Optimizely_self-hosting_for_Akamai_users">Optimizely self-hosting for Akamai users</a></p>
				<aside class="notes">
					The biggest win here is to serve the snippet over your connection. This removes at least three round-trips from the critical path.
				</aside>
			</section>
			<section class="center" data-background-image="../backgrounds/experimentation.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>Evaluate performance</h3>
				<img class="plain stretch" data-src="media/ab_tools.png"/>
				<p class="smallest bottom-right"><a href="https://orangevalley.nl/en/9-ab-testing-tools-compared-on-site-speed-impact/">How A/B testing tools worsen your site speed - orangevalley</a></p>
				<aside class="notes">
					Not all tools are created equally, so make sure you evaluate based on performance.
				</aside>
			</section>
			<section class="center" data-background-image="../backgrounds/experimentation.jpg" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.1">
				<h3>Use the platform</h3>
				<img class="plain stretch" data-src="media/optimizely_edge.png"/>
				<p class="smallest bottom-right"><a href="https://blog.optimizely.com/2019/09/12/performance-edge/">Introducing Performance Edge: Making Web Experiments Run Blazingly Fast</a></p>
				<aside class="notes">
					Optimizely knows the issue, and have released a product which dynamically generates the script at the edge to reduce bundle size.
				</aside>
			</section>
		</section>
		
		<section data-background-image="../backgrounds/book.jpg" data-background-fit="stretch">
			<br>
			<h2>What can we learn?</h2>
		</section>
		
		<section>
			<section class="center" data-background-color="#000">
				<blockquote>Everything should have a value<br>because everything has a cost</blockquote>
				<p class="smallest bottom-right">Tim Kadlec</p>
			</section>
			
			<section class="center" data-background-image="media/requestmap.png" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.25">
				<h3>Visibility is Key</h3>
				<ul>
					<li>WebPageTest & RequestMap</li>
					<li>CSP Reports</li>
					<li>Resource Timing in RUM</li>
				</ul>
				<p class="smallest bottom-right"><a href="https://csswizardry.com/2018/05/identifying-auditing-discussing-third-parties/">Identifying, Auditing, and Discussing Third Parties</a></p>
			</section>
			
			<section class="center" data-background-image="media/requestmap.png" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.25">
				<h3>Determine the risk &amp; value</h3>
				<ul>
					<li>WebPageTest Block & SPoF</li>
					<li>RUM Correlations</li>
					<li>Webbkoll by Dataskydd</li>
				</ul>
			</section>
			
			<section class="center" data-background-image="media/requestmap.png" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.25">
				<h3>Remove the unnecessary</h3>
				<ul>
					<li>Ownership & ROI</li>
					<li>Adaptive Loading</li>
					<li>Server-side equivalents</li>
				</ul>
			</section>
			
			<section class="center" data-background-image="media/requestmap.png" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.25">
				<h3>Immunise against the necessary</h3>
				<ul>
					<li>Proxy through your CDN</li>
					<li>Content-Security-Policy</li>
					<li>Subresource Integrity</li>
					<li>Minimise Customisation</li>
				</ul>
			</section>
			
			<section class="center" data-background-image="media/requestmap.png" data-background-fit="stretch" data-background-color="#000" data-background-opacity="0.25">
				<h3>Lock it down!</h3>
				<ul>
					<li>Lock down tag manager</li>
					<li>Business process for tags</li>
				</ul>
				<p class="smallest bottom-right"><a href="https://www.tunetheweb.com/blog/adding-controls-to-google-tag-manager/">Adding Controls to Google Tag Manager - Barry Pollard</a></p>
			</section>
			<!--
				<section class="center">
					<table class="matrix">
						<tr><th></th><th>Discovery</th><th>Impact</th><th>Reporting</th><th>Code Quality</th><th>Availability</th><th>Data Leakage</th><th>Performance</th></tr>
						<tr class="fragment"><td class="cell-challenge">Removal</td><td class="cell-lo"><td class="cell-lo"></td><td class="cell-lo"></td><td class="cell-hi"></td><td class="cell-hi"></td><td class="cell-hi"></td><td class="cell-hi"></td></tr>
						<tr class="fragment"><td class="cell-challenge">Synthetic</td>		<td class="cell-md"><td class="cell-hi"></td><td class="cell-md"></td><td class="cell-lo"></td><td class="cell-hi"></td><td class="cell-md"></td><td class="cell-md"></td></tr>
						<tr class="fragment"><td class="cell-challenge">RUM</td>				<td class="cell-md"><td class="cell-hi"></td><td class="cell-hi"></td><td class="cell-lo"></td><td class="cell-md"></td><td class="cell-md"></td><td class="cell-hi"></td></tr>
						<tr class="fragment"><td class="cell-challenge">CSP (RO)</td>		<td class="cell-hi"><td class="cell-lo"></td><td class="cell-hi"></td><td class="cell-md"></td><td class="cell-lo"></td><td class="cell-md"></td><td class="cell-lo"></td></tr>
						<tr class="fragment"><td class="cell-challenge">SRI / Versioning</td><td class="cell-lo"><td class="cell-lo"></td><td class="cell-md"></td><td class="cell-md"></td><td class="cell-lo"></td><td class="cell-md"></td><td class="cell-lo"></td></tr>
						<tr class="fragment"><td class="cell-challenge">CSP</td>				<td class="cell-hi"><td class="cell-lo"></td><td class="cell-hi"></td><td class="cell-hi"></td><td class="cell-lo"></td><td class="cell-hi"></td><td class="cell-lo"></td></tr>
						<tr class="fragment"><td class="cell-challenge">ServiceWorker</td>	<td class="cell-lo"><td class="cell-lo"></td><td class="cell-lo"></td><td class="cell-lo"></td><td class="cell-hi"></td><td class="cell-lo"></td><td class="cell-md"></td></tr>
						<tr class="fragment"><td class="cell-challenge">Self Hosting</td>	<td class="cell-lo"><td class="cell-lo"></td><td class="cell-lo"></td><td class="cell-md"></td><td class="cell-hi"></td><td class="cell-lo"></td><td class="cell-md"></td></tr>
					</table>
				</section>
			-->
		</section>
		
		<section>
			<section class="center left" data-background-image="../backgrounds/polarbear.jpg" data-background-fit="stretch" data-background-opacity="">
				<h2>Thank you</h2>
				<p><a href="https://twitter.com/SimonHearne">@SimonHearne</a></p>
				<p><a href="mailto:simon@hearne.me">simon@hearne.me</a></p>
				<p class="smallest"><a href="https://simonhearne.com/talks/">simonhearne.com/talks/</a></p>
				<p class="smallest"><a href="https://noti.st/simonhearne">noti.st/simonhearne</a></p>
			</section>
		</section>
		
	</div>
	<div id="chart-controls" class="hide"></div>
	
</div>

<script>
	!function init() {
		/* do something straight away */
	}()
	function getQueryVariable(variable)
	{
		var query = window.location.search.substring(1);
		var vars = query.split("&");
		for (var i=0;i<vars.length;i++) {
			var pair = vars[i].split("=");
			if(pair[0] == variable){return pair[1];}
		}
		return(false);
	}
	var presenting = window.location.search.includes('present');
	var duration = getQueryVariable('duration') || 30;
	var hasCode = !!document.querySelector('code');
	var hasAnims = !!document.querySelector('[data-animate]');
	var keyboard = {
		// pause/resume time when Enter is pressed
		13: () => {
			ElapsedTimeBar.isPaused ? ElapsedTimeBar.resume() : ElapsedTimeBar.pause();
		},
		// reset timer when 'r' is pressed
		82: () => {
			ElapsedTimeBar.reset();
		}
	}
	if (presenting) {
		keyboard = Object.assign(keyboard,
		{
			39: 'next',
			37: 'prev'
		});
	}
	function getFragment(event) {
		return (event.currentSlide.id !== "" ? event.currentSlide.id : null);
	}
	// More info https://github.com/hakimel/reveal.js#configuration
	Reveal.initialize({
		controls: !presenting,
		showNotes: !presenting,
		progress: true,
		history: true,
		center: false,
		transitionSpeed: 'default', // default/fast/slow
		
		transition: 'none', // none/fade/slide/convex/concave/zoom
		
		allottedTime: duration * 60 * 1000, // 30 minutes
		barColor: 'hsl(220,99%,54%)',
		
		// More info https://github.com/hakimel/reveal.js#dependencies
		dependencies: [
		{ src: '../lib/js/classList.js', 				async: true, condition: function() { return !document.body.classList; } },
		{ src: '../plugin/markdown/marked.js', 			async: true, condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
		{ src: '../plugin/markdown/markdown.js', 		async: true, condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
		{ src: '../plugin/embed-tweet/embed-tweet.js', 	async: false, condition: function() { return !!document.querySelector( 'div.tweet[data-src]' ); } },
		{ src: '../lib/js/vega.min.js', 				condition: function() { return !!document.querySelector( 'div.vega-chart' ); } },
		{ src: '../lib/js/vega-embed.min.js', 			condition: function() { return !!document.querySelector( 'div.vega-chart' ); } },
		{ src: '../plugin/elapsed-time-bar/elapsed-time-bar.js', async: true, condition: function() { return presenting}},
		{ src: '../plugin/highlight/highlight.js', 		async: true, condition: function() {return hasCode},async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
		{ src: '../plugin/search/search.js', 			async: true },
		{ src: '../plugin/zoom-js/zoom.js', 			async: true },
		{ src: '../plugin/notes/notes.js', 				async: true }
		],
		
		keyboard: keyboard
	});
	Reveal.addEventListener( 'slidechanged', function( event ) {
		let state = {h: event.indexh, v: event.indexv, name: getFragment(event)};
	} );
	
	/* animate.css */
	// Set animation delay if data-delay is specified
	Reveal.addEventListener('ready', function ( event ) {
		$('*[data-delay]').each( function () { 
			var delay = $(this).attr("data-delay");
			$(this).css("-webkit-animation-delay", delay+"s"); 
			$(this).css("animation-delay", delay+"s"); 
		});
	});
	
	// Set animation duration if data-duration is specified
	Reveal.addEventListener('ready', function ( event ) {
		$('*[data-duration]').each( function () { 
			var duration = $(this).attr("data-duration");
			$(this).css("-webkit-animation-duration", duration+"s"); 
			$(this).css("animation-duration", duration+"s"); 
		});
		let width = window.innerWidth / 2;
		$(".vega-chart").each(function() {
			let spec = this.attributes.getNamedItem("data-spec").value;
			//spec = "https://raw.githubusercontent.com/vega/vega/master/docs/examples/bar-chart.vg.json";
			vegaEmbed('#'+this.id, spec, {"actions": false, "theme": "dark", "width": width, "renderer": "svg", "config": "data/config.json"}).then(function(result) {
				// Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
			}).catch(console.error);
		});
	});
	
	// Animate items that are not in a fragment
	Reveal.addEventListener('slidechanged', function( event ) {
		// Animate elements that are not a fragment (or in a fragment)
		var filter = '*[data-animate]:not(.fragment):not(.fragment *)';
		
		$(event.currentSlide).find(filter).each( function () {
			$(this).addClass('animated');
			$(this).addClass($(this).attr('data-animate'));
		});		
		$(event.previousSlide).find(filter).each( function () {
			$(this).removeClass('animated');
			$(this).removeClass($(this).attr('data-animate'));
		});		
	});
	
	// Animate fragments
	Reveal.addEventListener('fragmentshown', function( event ) {
		function loop(i, el) { 
			if ($(el).attr('data-animate')) {
				$(el).addClass('animated');
				$(el).addClass($(el).attr('data-animate'));
			}
			$.each($(el).children().not('.fragment'), loop);
			if ($(el).attr('data-eval-show')) {
				eval($(el).attr('data-eval-show'))
			}
		};
		$.each(event.fragments, loop);
	});
	
	// Make the animation runnable again if fragment is hidden
	Reveal.addEventListener('fragmenthidden', function( event ) {	  
		function loop(i, el) { 
			if ($(el).attr('data-animate')) {
				$(el).removeClass('animated');
				$(el).removeClass($(el).attr('data-animate'));
			}
			$.each($(el).children().not('.fragment'), loop);
			if ($(el).attr('data-eval-hide')) {
				eval($(el).attr('data-eval-hide'))
			}
		};
		$.each(event.fragments, loop);
	});
	if (hasCode) {
		var l = document.createElement('link');
		l.rel="stylesheet";
		l.href = "../lib/css/zenburn.css"
		document.head.appendChild(l);
	}
	if (hasAnims) {
		var l = document.createElement('link');
		l.rel="stylesheet";
		l.href = "../lib/css/animate.min.css"
		document.head.appendChild(l);
	}
</script>

<script nonce="googleAnalytics">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();
		i.initAnalytics=function(){a=s.createElement(o),m=s.getElementsByTagName(o)[0];
			a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		}})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		
		ga('create', 'UA-6512525-16', 'auto', {'siteSpeedSampleRate': 100});
		ga('send', 'pageview');
		
		window.addEventListener('load',function(){initAnalytics()});
	</script>
</body>
</html>
